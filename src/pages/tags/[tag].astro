---
import Layout from '@layouts/Layout.astro';
import Container from '@components/Container.astro';
import { BLOG } from "@consts";
import ArrowCard from "@components/ArrowCard.astro";
import { getCollection } from "astro:content";

export async function getStaticPaths() {
  const tags = ["blog", "test", "コミュニティ", "ブログ", "後退", "公開学習"];
  return tags.map(tag => ({ params: { tag } }));
}

const { tag } = Astro.params;
const blog = (await getCollection("blog"))
  .filter((post) => !post.data.draft && post.data.tags.includes(tag))
  .sort((a, b) => b.data.date.valueOf() - a.data.date.valueOf())

---
<Layout title={tag} description={BLOG.DESCRIPTION}>
  <Container>
    <h2 class="font-semibold text-black dark:text-white">
      {tag}のタグが付いた記事
    </h2>
    <ul class="not-prose flex flex-col gap-4">
      {
        blog.map((post) => (
          <li>
            <ArrowCard entry={post} />
          </li>
        ))
      }
    </ul>
  </Container>
</Layout>
